<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>b6aa7cfda9a64e158d08899f16d369d0</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="hello-lets-investigate-these-datasets-first-well-import-the-needed-modules" class="cell markdown">
<h3>Hello! Let's investigate these datasets! First, we'll import the needed modules</h3>
</section>
<div class="cell code" data-execution_count="1" id="owj5jQFeNHVr">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span></code></pre></div>
</div>
<section id="buoys" class="cell markdown">
<h4>Buoys</h4>
</section>
<div class="cell markdown">
<p>Then, let's collect the data from the buoys and take a first look at it</p>
</div>
<div class="cell code" data-execution_count="2">
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">&#39;datasets</span><span class="ch">\\</span><span class="st">buoys&#39;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>buoys <span class="op">=</span> pd.concat(<span class="bu">map</span>(pd.read_csv, glob.glob(path <span class="op">+</span> <span class="st">&quot;/*.csv&quot;</span>)))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>buoys.head()</span></code></pre></div>
<div class="output stream stderr">
<pre><code>C:\Users\lu-lu\AppData\Roaming\Python\Python39\site-packages\IPython\core\interactiveshell.py:3418: DtypeWarning: Columns (0,1,4,5,6,7,8,9,10,11) have mixed types.Specify dtype option on import or set low_memory=False.
  exec(code_obj, self.user_global_ns, self.user_ns)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="2">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>time</th>
      <th>station_id</th>
      <th>PeakPeriod</th>
      <th>PeakDirection</th>
      <th>UpcrossPeriod</th>
      <th>SignificantWaveHeight</th>
      <th>Hmax</th>
      <th>SeaTemperature</th>
      <th>MeanCurSpeed</th>
      <th>MeanCurDirTo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>degrees_east</td>
      <td>degrees_north</td>
      <td>UTC</td>
      <td>NaN</td>
      <td>s</td>
      <td>degrees_true</td>
      <td>s</td>
      <td>cm</td>
      <td>cm</td>
      <td>degree_C</td>
      <td>m/s</td>
      <td>degrees_true</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-9.911498</td>
      <td>53.801353</td>
      <td>2021-10-30T00:03:00Z</td>
      <td>Clew Bay</td>
      <td>11.11</td>
      <td>281.3</td>
      <td>4.651</td>
      <td>85.0</td>
      <td>NaN</td>
      <td>13.3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-9.911498</td>
      <td>53.801353</td>
      <td>2021-10-30T00:33:00Z</td>
      <td>Clew Bay</td>
      <td>10.53</td>
      <td>272.8</td>
      <td>4.878</td>
      <td>86.0</td>
      <td>NaN</td>
      <td>13.3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-9.911498</td>
      <td>53.801353</td>
      <td>2021-10-30T01:03:00Z</td>
      <td>Clew Bay</td>
      <td>11.11</td>
      <td>308.0</td>
      <td>4.938</td>
      <td>84.0</td>
      <td>NaN</td>
      <td>13.25</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-9.911498</td>
      <td>53.801353</td>
      <td>2021-10-30T01:33:00Z</td>
      <td>Clew Bay</td>
      <td>10.53</td>
      <td>281.3</td>
      <td>4.598</td>
      <td>80.0</td>
      <td>NaN</td>
      <td>13.25</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="3">
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>buoys.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="3">
<pre><code>(335955, 12)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="4">
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>buoys.dtypes</span></code></pre></div>
<div class="output execute_result" data-execution_count="4">
<pre><code>longitude                object
latitude                 object
time                     object
station_id               object
PeakPeriod               object
PeakDirection            object
UpcrossPeriod            object
SignificantWaveHeight    object
Hmax                     object
SeaTemperature           object
MeanCurSpeed             object
MeanCurDirTo             object
dtype: object</code></pre>
</div>
</div>
<div class="cell markdown">
<p>We see here that we have a lot of data from the buoys and that all the features came as objects. We need some of them as numbers so we can analyse them! So I created the below function for that purpose: it gets all the columns, except the ones that need to remain as strings: the timestamp and the station name. All of the other ones will be cast as a numerical type.</p>
</div>
<div class="cell code" data-execution_count="5">
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> type_casting(df):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  col <span class="op">=</span> df.columns</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  col <span class="op">=</span> col.drop([<span class="st">&#39;time&#39;</span>, <span class="st">&#39;station_id&#39;</span>])</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  df1 <span class="op">=</span> df[col].astype(<span class="bu">float</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  df1[[<span class="st">&#39;time&#39;</span>, <span class="st">&#39;station_id&#39;</span>]] <span class="op">=</span> df[[<span class="st">&#39;time&#39;</span>, <span class="st">&#39;station_id&#39;</span>]]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> df1</span></code></pre></div>
</div>
<div class="cell markdown">
<p>I'll also eliminate the second row, since it has only the units in which the features are measured</p>
</div>
<div class="cell code" data-execution_count="6">
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>buoys.drop(<span class="dv">0</span>, axis <span class="op">=</span> <span class="dv">0</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>buoys.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="6">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>time</th>
      <th>station_id</th>
      <th>PeakPeriod</th>
      <th>PeakDirection</th>
      <th>UpcrossPeriod</th>
      <th>SignificantWaveHeight</th>
      <th>Hmax</th>
      <th>SeaTemperature</th>
      <th>MeanCurSpeed</th>
      <th>MeanCurDirTo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>-9.911498</td>
      <td>53.801353</td>
      <td>2021-10-30T00:03:00Z</td>
      <td>Clew Bay</td>
      <td>11.11</td>
      <td>281.3</td>
      <td>4.651</td>
      <td>85.0</td>
      <td>NaN</td>
      <td>13.3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-9.911498</td>
      <td>53.801353</td>
      <td>2021-10-30T00:33:00Z</td>
      <td>Clew Bay</td>
      <td>10.53</td>
      <td>272.8</td>
      <td>4.878</td>
      <td>86.0</td>
      <td>NaN</td>
      <td>13.3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-9.911498</td>
      <td>53.801353</td>
      <td>2021-10-30T01:03:00Z</td>
      <td>Clew Bay</td>
      <td>11.11</td>
      <td>308.0</td>
      <td>4.938</td>
      <td>84.0</td>
      <td>NaN</td>
      <td>13.25</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-9.911498</td>
      <td>53.801353</td>
      <td>2021-10-30T01:33:00Z</td>
      <td>Clew Bay</td>
      <td>10.53</td>
      <td>281.3</td>
      <td>4.598</td>
      <td>80.0</td>
      <td>NaN</td>
      <td>13.25</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-9.911498</td>
      <td>53.801353</td>
      <td>2021-10-30T02:03:00Z</td>
      <td>Clew Bay</td>
      <td>11.76</td>
      <td>285.5</td>
      <td>4.878</td>
      <td>74.0</td>
      <td>NaN</td>
      <td>13.2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p>Here we check for null values, eliminating the features with many such values we won't need, and eliminating the rows with null values that are left.</p>
</div>
<div class="cell code" data-execution_count="7">
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>buoys.isna().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="7">
<pre><code>longitude                     0
latitude                      0
time                          0
station_id                    0
PeakPeriod               229062
PeakDirection            229062
UpcrossPeriod            229062
SignificantWaveHeight    229062
Hmax                     290200
SeaTemperature                0
MeanCurSpeed             283050
MeanCurDirTo             283053
dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="8">
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>buoys.drop([<span class="st">&#39;MeanCurSpeed&#39;</span>, <span class="st">&#39;MeanCurDirTo&#39;</span>, <span class="st">&#39;PeakDirection&#39;</span>, <span class="st">&#39;UpcrossPeriod&#39;</span>], axis <span class="op">=</span> <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>buoys.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="9">
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>buoys <span class="op">=</span> type_casting(buoys) <span class="co">## casting some features as numerical</span></span></code></pre></div>
</div>
<div class="cell markdown">
<p>First, we will need the names of the stations</p>
</div>
<div class="cell code" data-execution_count="10">
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>stations <span class="op">=</span> buoys[<span class="st">&#39;station_id&#39;</span>].value_counts().index</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>stations</span></code></pre></div>
<div class="output execute_result" data-execution_count="10">
<pre><code>Index([&#39;Bantry Bay&#39;, &#39;Brandon Bay&#39;, &#39;SmartBay Wave Buoy&#39;, &#39;Clew Bay&#39;], dtype=&#39;object&#39;)</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Then, Let's build a function that gets the lowest temperature for each of the buoys and says when it happened</p>
</div>
<div class="cell code" data-execution_count="11">
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> min_temp(station):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  minimo <span class="op">=</span> <span class="bu">min</span>(buoys[buoys[<span class="st">&#39;station_id&#39;</span>] <span class="op">==</span> station][<span class="st">&#39;SeaTemperature&#39;</span>]) <span class="co">## Here we get the lowest temperature for the buoy</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  mes <span class="op">=</span> buoys[(buoys[<span class="st">&#39;SeaTemperature&#39;</span>] <span class="op">==</span> minimo) <span class="op">&amp;</span> (buoys[<span class="st">&#39;station_id&#39;</span>] <span class="op">==</span> station)][<span class="st">&#39;time&#39;</span>] <span class="co">## then we get all the times this temperature happened</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  date <span class="op">=</span> []</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> m <span class="kw">in</span> mes:  <span class="co">## We get there the specific month when it happened</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    date.append(datetime.datetime.strptime(m, <span class="st">&quot;%Y-%m-</span><span class="sc">%d</span><span class="st">T%H:%M:%SZ&quot;</span>))</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  month <span class="op">=</span> pd.DataFrame([x.strftime(<span class="st">&quot;%B&quot;</span>) <span class="cf">for</span> x <span class="kw">in</span> date]).value_counts().index[<span class="dv">0</span>][<span class="dv">0</span>]  <span class="co">## and here we select the month where the lowest temperature usually occurs</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span> (<span class="st">&quot;The lowest temperature for &quot;</span> <span class="op">+</span> <span class="bu">str</span>(station) <span class="op">+</span> <span class="st">&quot; is &quot;</span> <span class="op">+</span> <span class="bu">str</span>(minimo) <span class="op">+</span> <span class="st">&quot; and it occurs in &quot;</span> <span class="op">+</span> <span class="bu">str</span>(month))</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> minimo, month, station</span></code></pre></div>
</div>
<div class="cell markdown">
<p>Let's test this function!</p>
</div>
<div class="cell code" data-execution_count="12">
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>minima, months, station_ids <span class="op">=</span> [], [], []</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> stations:</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    minimum, month, station <span class="op">=</span> min_temp(i)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    minima.append(minimum)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    months.append(month)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    station_ids.append(station)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The lowest temperature for Bantry Bay is 5.82 and it occurs in March
The lowest temperature for Brandon Bay is 6.28 and it occurs in March
The lowest temperature for SmartBay Wave Buoy is 5.48 and it occurs in March
The lowest temperature for Clew Bay is 14.75 and it occurs in June
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>It seems that for most of the buoys, the lowest temperature occurs in march. But let's try to get this information visually</p>
</div>
<div class="cell code" data-execution_count="13">
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>ax.barh(station_ids, minima)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Temperature °C&#39;</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Station&#39;</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Lowest temperature for each buoy.&#39;</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56ad61822b0d47378626c88794bc3120/75798a90d59b8603700a00103a3a8ed0298407a7.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>We now know that SmartBay Wave Buoy is the coldest one!</p>
</div>
<div class="cell code" data-execution_count="14">
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mon <span class="op">=</span> pd.DataFrame(months)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>vc <span class="op">=</span> mon.value_counts()</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>ax.pie(vc[<span class="dv">0</span>:], labels <span class="op">=</span> mon[<span class="dv">0</span>].value_counts().index, autopct<span class="op">=</span><span class="st">&#39;</span><span class="sc">%1.1f%%</span><span class="st">&#39;</span>,)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Months with the lowest temperatures&#39;</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56ad61822b0d47378626c88794bc3120/86583dc715bfcbe941de268b1aadd7c2d530c095.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>We can see that the coldest month is march!</p>
</div>
<section id="tides" class="cell markdown">
<h4>Tides</h4>
</section>
<div class="cell markdown">
<p>Now let's look at the tides data</p>
</div>
<div class="cell code" data-execution_count="15" data-colab="{&quot;height&quot;:444,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="dfpkJV70NQDI" data-outputId="cc699c3a-faa4-4ee4-c9b7-94db58d44c97">
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">&#39;datasets</span><span class="ch">\\</span><span class="st">tides&#39;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>tides <span class="op">=</span> pd.concat(<span class="bu">map</span>(pd.read_csv, glob.glob(path <span class="op">+</span> <span class="st">&quot;/*.csv&quot;</span>)))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>tides.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="15">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>station_id</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>Water_Level_LAT</th>
      <th>Water_Level_OD_Malin</th>
      <th>QC_Flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>UTC</td>
      <td>NaN</td>
      <td>degrees_north</td>
      <td>degrees_east</td>
      <td>metres</td>
      <td>metres</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-08-19T17:20:00Z</td>
      <td>Wexford Harbour</td>
      <td>52.3385</td>
      <td>-6.4589</td>
      <td>1.251</td>
      <td>0.295</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-08-19T17:25:00Z</td>
      <td>Wexford Harbour</td>
      <td>52.3385</td>
      <td>-6.4589</td>
      <td>1.243</td>
      <td>0.287</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-08-19T17:30:00Z</td>
      <td>Wexford Harbour</td>
      <td>52.3385</td>
      <td>-6.4589</td>
      <td>1.219</td>
      <td>0.263</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-08-19T17:35:00Z</td>
      <td>Wexford Harbour</td>
      <td>52.3385</td>
      <td>-6.4589</td>
      <td>1.208</td>
      <td>0.252</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="16">
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tides.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="16">
<pre><code>(1364748, 7)</code></pre>
</div>
</div>
<div class="cell markdown">
<p>We have a very large dataset!</p>
</div>
<div class="cell code" data-execution_count="17" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="b4EvL0LMlRTy" data-outputId="573be592-6909-4933-d1e9-fd6f76b33538">
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tides.dtypes</span></code></pre></div>
<div class="output execute_result" data-execution_count="17">
<pre><code>time                     object
station_id               object
latitude                 object
longitude                object
Water_Level_LAT          object
Water_Level_OD_Malin     object
QC_Flag                 float64
dtype: object</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Let's eliminate the first row, which contains only information about the units, and all the null values</p>
</div>
<div class="cell code" data-execution_count="18">
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>tides.drop(<span class="dv">0</span>, axis <span class="op">=</span> <span class="dv">0</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>tides.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>tides.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="18">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>station_id</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>Water_Level_LAT</th>
      <th>Water_Level_OD_Malin</th>
      <th>QC_Flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2021-08-19T17:20:00Z</td>
      <td>Wexford Harbour</td>
      <td>52.3385</td>
      <td>-6.4589</td>
      <td>1.251</td>
      <td>0.295</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-08-19T17:25:00Z</td>
      <td>Wexford Harbour</td>
      <td>52.3385</td>
      <td>-6.4589</td>
      <td>1.243</td>
      <td>0.287</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-08-19T17:30:00Z</td>
      <td>Wexford Harbour</td>
      <td>52.3385</td>
      <td>-6.4589</td>
      <td>1.219</td>
      <td>0.263</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-08-19T17:35:00Z</td>
      <td>Wexford Harbour</td>
      <td>52.3385</td>
      <td>-6.4589</td>
      <td>1.208</td>
      <td>0.252</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2021-08-19T17:40:00Z</td>
      <td>Wexford Harbour</td>
      <td>52.3385</td>
      <td>-6.4589</td>
      <td>1.202</td>
      <td>0.246</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="19">
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>stations <span class="op">=</span> tides[<span class="st">&#39;station_id&#39;</span>].value_counts().index</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>stations</span></code></pre></div>
<div class="output execute_result" data-execution_count="19">
<pre><code>Index([&#39;Galway Port&#39;, &#39;Wexford Harbour&#39;, &#39;Dublin Port&#39;, &#39;Ballyglass Harbour&#39;,
       &#39;Union Hall Harbor&#39;, &#39;Roonagh Pier&#39;, &#39;Aranmore Island - Leabgarrow&#39;,
       &#39;Dingle Harbour&#39;, &#39;Castletownbere Port&#39;, &#39;Skerries Harbour&#39;,
       &#39;Killybegs Port&#39;, &#39;Sligo&#39;, &#39;Ballycotton Harbour&#39;],
      dtype=&#39;object&#39;)</code></pre>
</div>
</div>
<div class="cell markdown">
<p>And, once again, all the features come as objects, so we need to cast them to numeric types</p>
</div>
<div class="cell code" data-execution_count="20" id="68GVrxlXlTif">
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>tides <span class="op">=</span> type_casting(tides)</span></code></pre></div>
</div>
<div class="cell markdown">
<p>We need to figure out where the biggest water level occurs, so we will look at the Water Level Lat for all tides.</p>
</div>
<div class="cell code" data-execution_count="21" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="_jAtMksfb8MQ" data-outputId="fe9e893c-c1c2-4fc7-b250-51920b67c1e8">
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> max_water_level(station):</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  maximo <span class="op">=</span> <span class="bu">max</span>(tides[tides[<span class="st">&#39;station_id&#39;</span>] <span class="op">==</span> station][<span class="st">&#39;Water_Level_LAT&#39;</span>])</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  mes <span class="op">=</span> tides[(tides[<span class="st">&#39;Water_Level_LAT&#39;</span>] <span class="op">==</span> maximo) <span class="op">&amp;</span> (tides[<span class="st">&#39;station_id&#39;</span>] <span class="op">==</span> station)][<span class="st">&#39;time&#39;</span>]</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  lat <span class="op">=</span> tides[(tides[<span class="st">&#39;Water_Level_LAT&#39;</span>] <span class="op">==</span> maximo) <span class="op">&amp;</span> (tides[<span class="st">&#39;station_id&#39;</span>] <span class="op">==</span> station)][<span class="st">&#39;latitude&#39;</span>].values[<span class="dv">0</span>]</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  longi <span class="op">=</span> tides[(tides[<span class="st">&#39;Water_Level_LAT&#39;</span>] <span class="op">==</span> maximo) <span class="op">&amp;</span> (tides[<span class="st">&#39;station_id&#39;</span>] <span class="op">==</span> station)][<span class="st">&#39;longitude&#39;</span>].values[<span class="dv">0</span>]</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  date <span class="op">=</span> []</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> m <span class="kw">in</span> mes:</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    date.append(datetime.datetime.strptime(m, <span class="st">&quot;%Y-%m-</span><span class="sc">%d</span><span class="st">T%H:%M:%SZ&quot;</span>))</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  month <span class="op">=</span> pd.DataFrame([x.strftime(<span class="st">&quot;%B&quot;</span>) <span class="cf">for</span> x <span class="kw">in</span> date]).value_counts().index[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span> (<span class="st">&quot;The biggest water level occurs at LAT: &quot;</span> <span class="op">+</span> <span class="bu">str</span>(lat) <span class="op">+</span> <span class="st">&quot;, LONG: &quot;</span> <span class="op">+</span> <span class="bu">str</span> (longi) <span class="op">+</span> <span class="st">&quot; in &quot;</span> <span class="op">+</span> station <span class="op">+</span> <span class="st">&quot; at &quot;</span> <span class="op">+</span> <span class="bu">str</span>(maximo) <span class="op">+</span> <span class="st">&quot; meters and it occurs in &quot;</span> <span class="op">+</span> <span class="bu">str</span>(month))</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> lat, longi, month, maximo, station</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="22">
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>latitudes, longitudes, months, maxima, station_ids <span class="op">=</span> [], [], [], [], []</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> stations:</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    lat, longi, month, maxi, station_id <span class="op">=</span> max_water_level(i)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    latitudes.append(lat)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    longitudes.append(longi)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    months.append(month)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    maxima.append(maxi)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    station_ids.append(station_id)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The biggest water level occurs at LAT: 53.269, LONG: -9.048 in Galway Port at 6.143 meters and it occurs in December
The biggest water level occurs at LAT: 52.3385, LONG: -6.4589 in Wexford Harbour at 2.286 meters and it occurs in December
The biggest water level occurs at LAT: 53.3457, LONG: -6.2217 in Dublin Port at 4.783 meters and it occurs in January
The biggest water level occurs at LAT: 54.2536, LONG: -9.8928 in Ballyglass Harbour at 4.266 meters and it occurs in February
The biggest water level occurs at LAT: 51.558964, LONG: -9.13349 in Union Hall Harbor at 4.227 meters and it occurs in December
The biggest water level occurs at LAT: 53.76235, LONG: -9.90442 in Roonagh Pier at 5.117 meters and it occurs in December
The biggest water level occurs at LAT: 54.9905, LONG: -8.4955 in Aranmore Island - Leabgarrow at 4.717 meters and it occurs in January
The biggest water level occurs at LAT: 52.13924, LONG: -10.27732 in Dingle Harbour at 5.081 meters and it occurs in December
The biggest water level occurs at LAT: 51.6496, LONG: -9.9034 in Castletownbere Port at 4.272 meters and it occurs in December
The biggest water level occurs at LAT: 53.585, LONG: -6.1081 in Skerries Harbour at 5.287 meters and it occurs in February
The biggest water level occurs at LAT: 54.6364, LONG: -8.3949 in Killybegs Port at 4.656 meters and it occurs in February
The biggest water level occurs at LAT: 54.3099, LONG: -8.582 in Sligo at 4.584 meters and it occurs in August
The biggest water level occurs at LAT: 51.8278, LONG: -8.0007 in Ballycotton Harbour at 4.704 meters and it occurs in February
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="23">
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>ax.barh(station_ids, maxima)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Water level (meters)&#39;</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Station&#39;</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Biggest water level per station&#39;</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56ad61822b0d47378626c88794bc3120/c31490e9a356ca2f71d7180db862859982260e5b.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="24">
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>max_water_level(<span class="st">&#39;Galway Port&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The biggest water level occurs at LAT: 53.269, LONG: -9.048 in Galway Port at 6.143 meters and it occurs in December
</code></pre>
</div>
<div class="output execute_result" data-execution_count="24">
<pre><code>(53.269, -9.048, &#39;December&#39;, 6.143, &#39;Galway Port&#39;)</code></pre>
</div>
</div>
<div class="cell markdown">
<p>We can see here that the biggest of all waves occurs in Galway Port! But let's see when most of the big waves occur:</p>
</div>
<div class="cell code" data-execution_count="25">
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>mon <span class="op">=</span> pd.DataFrame(months)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>vc <span class="op">=</span> mon.value_counts()</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>ax.pie(vc[<span class="dv">0</span>:], labels <span class="op">=</span> mon[<span class="dv">0</span>].value_counts().index, autopct<span class="op">=</span><span class="st">&#39;</span><span class="sc">%1.1f%%</span><span class="st">&#39;</span>,)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Months with the biggest waves&#39;</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_56ad61822b0d47378626c88794bc3120/8abbde5cbb1c75940fd2270c7b3b67d4c89e0ec7.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>Now we know that December is the month when the biggest waves happen!</p>
</div>
<section id="buoys-again" class="cell markdown">
<h4>Buoys again</h4>
</section>
<div class="cell markdown">
<p>First, to get the wave length, we need to calculate it. According to the Ocean Data Labs, the Wave length is L = gT²/2pi, where g=9.8m/s². So, let's calculate it and aggregate to our data:</p>
</div>
<div class="cell code" data-execution_count="36">
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> wavelength(T):</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> <span class="fl">9.8</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g <span class="op">*</span>(T <span class="op">**</span> <span class="dv">2</span>) <span class="op">/</span> (<span class="dv">2</span><span class="op">*</span>np.pi)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="37">
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>buoys[<span class="st">&#39;wavelength&#39;</span>] <span class="op">=</span> buoys[<span class="st">&#39;PeakPeriod&#39;</span>].<span class="bu">apply</span>(wavelength)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="38">
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>buoys.corr()</span></code></pre></div>
<div class="output execute_result" data-execution_count="38">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>PeakPeriod</th>
      <th>SignificantWaveHeight</th>
      <th>Hmax</th>
      <th>SeaTemperature</th>
      <th>wavelength</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>longitude</th>
      <td>1.000000</td>
      <td>0.514141</td>
      <td>-0.518752</td>
      <td>-0.403424</td>
      <td>-0.399717</td>
      <td>0.036289</td>
      <td>-0.481078</td>
    </tr>
    <tr>
      <th>latitude</th>
      <td>0.514141</td>
      <td>1.000000</td>
      <td>-0.294099</td>
      <td>0.102472</td>
      <td>0.106403</td>
      <td>-0.032596</td>
      <td>-0.243233</td>
    </tr>
    <tr>
      <th>PeakPeriod</th>
      <td>-0.518752</td>
      <td>-0.294099</td>
      <td>1.000000</td>
      <td>0.370907</td>
      <td>0.354117</td>
      <td>-0.283511</td>
      <td>0.968564</td>
    </tr>
    <tr>
      <th>SignificantWaveHeight</th>
      <td>-0.403424</td>
      <td>0.102472</td>
      <td>0.370907</td>
      <td>1.000000</td>
      <td>0.988224</td>
      <td>-0.332236</td>
      <td>0.407566</td>
    </tr>
    <tr>
      <th>Hmax</th>
      <td>-0.399717</td>
      <td>0.106403</td>
      <td>0.354117</td>
      <td>0.988224</td>
      <td>1.000000</td>
      <td>-0.328623</td>
      <td>0.386573</td>
    </tr>
    <tr>
      <th>SeaTemperature</th>
      <td>0.036289</td>
      <td>-0.032596</td>
      <td>-0.283511</td>
      <td>-0.332236</td>
      <td>-0.328623</td>
      <td>1.000000</td>
      <td>-0.284881</td>
    </tr>
    <tr>
      <th>wavelength</th>
      <td>-0.481078</td>
      <td>-0.243233</td>
      <td>0.968564</td>
      <td>0.407566</td>
      <td>0.386573</td>
      <td>-0.284881</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="39" data-colab="{&quot;height&quot;:333,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="zqt7DfJfiZNv" data-outputId="503cd973-df34-4b35-a6b5-d7a9ce688a2d">
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>buoys.corr()[<span class="st">&#39;wavelength&#39;</span>][<span class="st">&#39;SeaTemperature&#39;</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="39">
<pre><code>-0.28488129948919544</code></pre>
</div>
</div>
<div class="cell markdown">
<p>We can see that the wave length has some correlation with the sea temperature, but it's not that strong. Let's see how a simple model like linear regression does.</p>
</div>
<div class="cell code" data-execution_count="40" id="-0o56qYooW4y">
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="42" id="-W9rPBAIpNVq">
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>LR <span class="op">=</span> LinearRegression()</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(buoys[[<span class="st">&#39;SeaTemperature&#39;</span>, <span class="st">&#39;longitude&#39;</span>, <span class="st">&#39;latitude&#39;</span>]], buoys[<span class="st">&#39;wavelength&#39;</span>], test_size<span class="op">=</span><span class="fl">0.33</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="43" id="PhPEoQHIpXxb">
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>LR.fit(X_train, y_train)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> LR.predict(X_test)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="44" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="cPoFdUwDqDoi" data-outputId="a626e2c4-de03-4732-cc18-e2240d92a435">
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean_squared_error(y_test, y_pred, squared <span class="op">=</span> <span class="va">False</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>88.41031786831465
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="46" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="E3GZafg6qc8c" data-outputId="879adb72-9d0a-472f-bae4-341ecbfa8e48">
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>buoys[<span class="st">&#39;wavelength&#39;</span>].describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="46">
<pre><code>count    45746.000000
mean       162.400514
std        105.814511
min          2.245995
25%         85.641176
50%        155.971844
75%        215.705317
max        974.824026
Name: wavelength, dtype: float64</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Although the RMSE score, which measures how far the predictions are from the true value, is a bit high, we can see that it is smaller than the standard deviation of the wave length, so I would say it's a pretty good guess, given the low correlation!</p>
</div>
</body>
</html>
